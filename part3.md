# ROIの試算式の詳細と実際

今回はROIの試算式の詳細を解説し、実際にこの試算式でスモークテストとGUIテストの自動化のROIを求めてみます。

## 試算式の構成要素の詳細な解説

前回で Cost Benefits Analysis of Test Automation の以下の試算式を紹介しました。

ROI(t) = Δ手動テストに対するテスト自動化の利益 / Δ手動テスト対するテスト自動化のコスト = ΔB(t) / ΔC(t)
ΔB(t) = Σ(自動テストによる固定費の改善)(t) + Σ(N2回手動テストを実施した場合の変動費)(t) - Σ(N1回自動テストを実施した場合の変動費)(t)
ΔC(t) = Σ(自動テストによる固定費の増加)(t) + Σ(自動テストの開発費) - Σ(手動テストの開発費) + Σ(自動テストのメンテナンスコスト) (n1/N)
n1 = 自動テストの実行回数
n2 = 手動テストの実行回数
N = メンテナンスが必要になるまでの自動テストの平均実行回数

各要素を順に見ていきましょう。

「自動テストによる固定費の改善」とはテストの実行回数に依存しないテスト計画やテスト設計など、手動テストと自動テストで共通に発生するコストで改善された差分です。逆に自動テストを考慮した精緻化したテスト設計が必要になり追加コストが必要になりマイナスになる場合もあります。

手動テストと自動テストで実行回数を N2 と N1 で分けているのは通常、自動テストの実行の方が1回あたりのコストとかかる実行時間が短く、実行頻度が異なるためです。手動テストの場合は実行コストが高いため、テスト対象アプリケーションのビルド毎にテストを実行するのは難しいですが、自動テストの場合、実行コストが低いため、頻度を上げて素早く、障害を検出することができます。ただし、注意しなければならないのは N のメンテナンスが必要になるまでの自動テストの平均実行回数です。自動テストのテストレベルやテストタイプにもよりますが、対象アプリケーションのGUIやロジックの変化により，テストスクリプトの修正が必要になるため、最悪 N = 1 の自動テストの実行毎にメンテナンスコストが発生する場合があります。テストスクリプトの構造化、データ駆動化、オブジェクトマップやページオブジェクトによるGUI要素の抽象化などによってメンテナンスコストを下げると共に最適な N を検討する必要があります。

「自動テストによる固定費の増加」はテストツールのライセンスやサポートなど手動テストでは発生しない自動テストを導入した場合のコストです。ライセンス期間やアップグレードのコストがあるため、時間 t の関数になります。

「手動テストの開発費」は手動テストを続けた場合にかかっていたであろうコストでこれをマイナスすることにより、手動テストに対する自動テストの相対的な初期投資を算出しています。

第2回で解説したように固定費と変動費は更に詳細な要素に分解することもできますが、詳細に分解しない合算値からでもある程度妥当性があるものが出せると  Cost Benefits Analysis of Test Automation では述べています。筆者もまずは手動テストの単価計算に基づいた概算でも良いので算出できる要素から ROI を試算し、複数の施策を比較検討するのをお勧めします。

## スモークテストの自動化でのROIの試算

## GUIテストの自動化でのROIの試算
