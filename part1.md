# テスト自動化とROI

## はじめに

本連載を担当させていただきますテスト自動化研究会(STAR, https://sites.google.com/site/testautomationresearch/ )の太田健一郎と申します。本連載では読者の皆様がテスト自動化の導入理由や効果の測定をROIという観点で説明できるように、テスト自動化のROIの概念から実際の計算式までを3回に渡って解説させていただきます。

連載の流れは以下の通りです。

1. テスト自動化とROI
2. ROIの試算式の構成要素と試算式
3. ROIの試算式の詳細と実際

本連載の対象読者は以下を想定しています。

* テスト自動化を推進するエンジニア
* テスト自動化の定性的な効果は理解しているが、定量的な説明がうまくできないエンジニア

本連載で取り上げる内容は以下の通りです。

* テスト自動化のROIを試算する際の構成要素
* 目的に応じた複数のROIの試算式
* 具体例を使ったROIの試算

本連載では以下の内容は取り上げません。

* ROIの試算とは直接関係ないテスト自動化のアンチパターンやベストプラクティス
* 特定のテストレベルやテストタイプに依存するROIの話題
* ROIを試算した後にテスト自動化を成功裏に導入するノウハウ

## テスト自動化におけるROIの必要性

筆者は現在第三者検証のSHIFT( http://www.shiftinc.jp/ )という会社に属し、エンタープライズからWeb、ゲームなど多岐にわたる業界のお客様へテスト自動化やCIの導入支援をさせて頂いています。このようにテスト自動化を外部からご支援させて頂く場合だけなく、社内の品質改善や効率化改善の一環としてテスト自動化を推進する場合であっても、人件費を始めとする自動化のためのコストが発生します。そのため、よほど小規模なものでない限り、予算や契約を取り付けるためには定性的な効果以外に数値的な根拠が必要になります。すわなち、テスト自動化のためにはどれだけコストがかかり、いつの時点からコスト削減効果が見込めるのか、また、自動化を続けていく際の継続的なコストはどれだけかなどを数値で説明できる必要があります。

筆者の案件での経験では、テスト自動化に限らず、何らかの品質改善活動やコスト低減活動には、必要コストの絶対額、コスト削減の絶対額(つまりコスト削減による利益)や損益分岐点までの時間などを根拠にする場合ことが多いです。現状と実施すべき施策がほぼ確定している場合は人件費の積み上げコストと削減額でも問題ありませんが、テスト自動化のような対象となるテストレベル、テストタイプ、使用するツールが複数あり、複数の施策のうちどの施策を最初に着手すべきかを検討する場合、その施策は他の施策と比べてどれだけ投資効率が良いのかを比較検討できることがのぞましいです。このような目的のために、組織や企業の投資効率を利益 / 投資額 * 100で求められるROI(return on investment, 投資利益率、投資収益率、投資回収率、http://www.itmedia.co.jp/im/articles/0608/05/news017.html )が利用できます。ROIを利用した場合、投資効率を比率で比較できるため、単純に投資額や投資期期間を比較する場合に比べて、複数の施策を比較検討しやすくなります。単に手動テストに対して自動テストを導入する効果を試算するだけなく、ユニットテストとシステムテストの自動化、静的検証の導入など複数の施策を同時に検討できるようになります。

## テスト自動化の3つの目的とROIの関係

読者の皆様が自動テストを導入する目的は何でしょうか？テスト実行時間の短縮やテスト対象ソフトウェアの品質向上など様々な目的があると思います。テスト自動化の目的に対して、テスト自動化の知識体系であるTABOK(Test Automation Body of Knowledge, http://www.automatedtestinginstitute.com/home/index.php?option=com_content&view=article&id=1352&Itemid=189 )ではテスト自動化の効果は最終的に以下の三つに集約できると述べています。

* コストの削減 - 繰り返し実行可能で再利用できる自動テストや、従業員の工数削減、欠陥の早期の発見と修正、再作業の削減によって長期間のコスト削減となります
* 効率の向上 - テスト実行時間とスケジュールの短縮によって、テストの効率を向上させます
* ソフトウェア品質の向上 - 対象のソフトウェアとハードウェアのテスト実行カバレッジを増加させることにより、リリース前の潜在欠陥のリスクとコストを低減します

同時に、効率の向上とソフトウェア品質の向上は障害対応コストを考慮した場合、最終的にはコストの削減に還元できると説明しています。このため、TABOKが解説しているテスト自動化のコンテキストでは、テスト自動化の効果や目的は最終的にはコストという指標に還元でき、ROIで試算や評価できると言えます。本連載でもこのTABOKの解釈を元に、テスト自動化の目的や効果はコストに還元でき、ROIを試算できるとして解説を進めていきます。

## テスト自動化におけるROIの定義

実際にテスト自動化のROIの計算方法を説明していく前に会計学上のROIの定義を示しておきます。

ROI = (当期営業利益 + 減価償却費) / (株主資本 + 有利子負債) * 100

テスト自動化の場合、直接営業利益に繋がったり、株式を発行して資本を集めたりしているわけではないため、もう一段階抽象化して、その後テスト自動化のROIで利用する要素を当てはめてみることにします。抽象化したROIの式は以下になります。

ROI = 利益 / 投資額 * 100

ROIの構成要素と試算例を解説しているThe Return on Investment (ROI) of Test Automation( http://www.arcondis.com/assets/files/pdf/publikationen/ROI%20of%20Test%20Automation.pdf )を元に現在手動のテストを自動化した場合を考えてみましょう。ROIを自動テストを開発し、運用しているある時間tの関数とします。

ROI(t) = 利益(t) / 投資額(t) * 100

利益(t) = 手動テストを続けた場合の運用コスト(t) - 自動テストの運用コスト(t)

利益は手動テストを続けた場合の運用コストと自動テストを開始した後の運用コストの差分として定義します。

投資額については2つの解釈があります。

先ほどThe Return on Investment (ROI) of Test Automationでは以下のように自動テストの初期開発コストのみを投資額としています。

投資額 = 自動テストの初期開発コスト (時間tの関数にはなりません)

一方、Cost Benefits Analysis of Test Automation( http://www.softwarequalitymethods.com/papers/star99%20model%20paper.pdf )を始めとする他のテスト自動化のROIを解説している記事や論文では以下のように時間tの関数となる自動テストの運用コストを含めています。

投資額(t) = 自動テストの初期開発コスト + 自動テストの運用コスト(t)

まとめると、投資額に自動テストの運用コストを含めないか、含めるかで以下の2つの式があることになります。

1. ROI(t) = (手動テストを続けた場合の運用コスト(t) - 自動テストの運用コスト(t)) / 自動テストの初期開発コスト
2. ROI(t) = (手動テストを続けた場合の運用コスト(t) - 自動テストの運用コスト(t)) / (自動テストの初期開発コスト + 自動テストの運用コスト(t))

式1.は分母に自動テストの運用コスト(t)を含めないために、ROIは同じtではより高い値となり、同じROIを達成するにはより短いtで済むことになります。組織や目的に応じてどちらの式を使用してもかまいませんが、同一組織で複数の施策や期間を比較する場合には同一の式を使用する必要があります。筆者がテスト自動化のROIについての複数の文献を調査したところ、式2.に基づく試算や分析をしている文献が多かったため、本連載では以降式2.に基づいてROIの試算式を解説していきます。

## 次回予告

ROIの式を構成する要素として以下である事が分かりました。

* 手動テストを続けた場合の運用コスト
* 自動テストの運用コスト
* 自動テストの初期開発コスト

これは単純に上記に関わるエンジニアの工数を積み上げれば出てくるものでしょうか？例えば、有償ツールを採用した場合、ツールの購入コストが自動テストの初期購入コストに組み入れるのか、あるいは時間tの減価償却コストとして自動テストの運用コストに組み入れるべきか、時間tまでで手動テストと自動テストの実行頻度が異なる場合どのように各運用の実施コストを考えるべきか、障害の対応コストはテストの運用コストに組み入れるべきかなど、実際にROIを試算してみようとするとまだ分からないことが沢山あると思います。

次回ではそのようなROIの式の構成する要素をThe Return on Investment(ROI) of Test Automationから引用しながら解説していきます。
