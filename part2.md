# 試算式の構成要素と試算式の例

第1回でテスト自動化のROIは以下のようにして求められることを解説しました。

ROI(t) = (手動テストを続けた場合の運用コスト(t) - 自動テストの運用コスト(t)) / (自動テストの初期開発コスト + 自動テストの運用コスト(t))

第2回では各コストを分解した構成要素とその構成要素を使った試算式を解説します。

## テスト自動化のROIの試算式の構成要素

まず、ROIの試算式の構成要素について、The Return on Investsment (ROI) of Test Automation と Cost Benefits Analysis of Test Automation の解説例を見ていきます。

### The Return on Investsment (ROI) of Test Automationで解説している構成要素

The Return on Investsment (ROI) of Test Automation ( http://www.arcondis.com/assets/files/pdf/publikationen/ROI%20of%20Test%20Automation.pdf ) ではROIの構成要素として下記を挙げています。

要素|説明|手運コ|自開コ|自運コ|直接|間接
----|----|------|------|------|----|----
テストケース数|実行する総テストケース数(手動、自動両方)|○||○|○|
自動化対象のテストケース数|自動化を予定しているテストケース数||○|○|○|
サイクルあたりの実行テストケース数|各サイクルで実行するテストケース数|○||○|○|
テストサイクル数|ROIの評価対象期間でのテストサイクル数(週毎、ビルド毎、リリース毎など)|○||○|○|
テスターの時間単価|テスターの平均時間単価|○|||○|
欠陥コスト|本番環境での欠陥に対する予想対応コスト|○||○||○
手動テストの実行・分析時間|1つの手動テストの実行と結果の分析にかかる平均時間|○|||○|
ツールの取得、検証、ライセンスコスト|テストツールにかかるコスト||○||○|
ツールのトレーニングコスト|ツールの習得に必要なトレーニングコスト||○||○|
テスト実行マシンのコスト|手動テスト環境とは分離した自動テスト用のマシン環境のコスト||○|○|○|
自動テスト環境の構築コスト|自動テストの環境が使用できるまでのコスト||○||○|
自動テストの開発時間|テストスクリプトの開発に必要な時間||○|○|○|
自動テストの実行時間|自動テスト1ケースあたりの平均実行時間|||○|○|
自動テストの結果分析時間|1サイクルの自動テストの実行結果の平均分析時間|||○|○|
自動テストの平均メンテナンス時間|1サイクルの自動テストを実行するためにメンテナンスにかかる平均時間|||○|○|
夜間実行の実施|昼間だけでなく夜間にも実行するか？|||○|○|

属性の意味は下記の通りです。

* 手運コ = 手動テストの運用コスト
* 自開コ = 自動テストの初期開発コスト
* 自運コ = 自動テストの運用コスト
* 直接 = テスト部門で直接発生するコスト
* 間接 = テスト部門外で間接的に発生するコスト

テスト部門内で完結する手動テストと自動テストの運用コストは各単位時間あたりのコストと実行時間を積み上げていけば算出できます。

テスト部門外の欠陥コストについては、発生する欠陥の頻度、重要度によって異なり、自動化された後の値は同一の規模や特性を持ったソフトウェアからのベンチマークになるため、精確な予想値を求めるのが困難な場合があります。このため、簡易的なテスト部門内に完結したROIでは使用しない場合もあります。

また、後述の複数の試算式で解説しますが、手動テストを自動化する場合に、手動テストが外注でそのまま自動化して置き換えるというようなシナリオを除くと、手動テストの人員は別のアプリケーションのテストや異なったテストタイプを担当して固定費としてはそのまま存続することがあります。この場合、テスト自動化対象のアプリケーション単独では手動テストと自動テストのコストからROIを算出できますが、テスト部門として考えた場合、欠陥コストのような間接コストを考慮しないとテスト部門としてのコスト改善はされていない可能性があります。このため、組織やチームの構成に応じて後述の試算式を使い分けてコストを積み上げる必要があります。

### Cost Benefits Analysis of Test Automationで解説している要素

Cost Benefits Analysis of Test Automation ( http://www.softwarequalitymethods.com/papers/star99%20model%20paper.pdf )では、自動テストのコストの分類をテストの実行回数に依存しない固定費と実行回数の関数になるコストに分類しています。

* 固定費
 - ハードウェア (追加及びアップグレードも含む)
 - 自動テストで使用するソフトウェア(テストウェア)のライセンス
 - テストウェアのサポートコスト
 - テストウェアの接続ライセンス
 - 自動テスト環境の設計と実装
 - 自動化環境のメンテナンス
 - 自動化スクリプト作成ツール
 - 自動テストツールと自動テスト環境のライセンス
 - ツールのトレーニング
 - ツールの導入とアップデート
* 実行回数に依存するコスト
 - 自動テストのためのテスト設計
 - 自動テストのテストケースの実装
 - 自動テストのメンテナンス
 - テストオラクルの作成
 - 自動テストの実行
 - テスト結果の分析
 - 障害報告
 - テスト実行の報告

一方手動テストでも自動テストでも共通に実施する要素もあり、下記を挙げています。

* 共通要素
 - テスト対象の分析
 - テスト計画
 - 基本テスト設計
 - 手動テストも含めた障害報告
 - テスト結果のマネジメント向け報告

これらは自動テストの場合、手動テストより精緻化する必要があるため、コストは上昇しますが、自動テスト化することによるコスト削減効果によって相殺されることが多いため、ROIの試算には通常組み込まれません。ただし、実際にテスト自動化を開始すると手動のテストそのままを自動化することは少なく、上記の要素の精緻化に伴いテスト設計やテストケース実装の改善、テストカバレッジの増加が発生する可能性が高いため、自動化による結果としてのROIは試算したROI通りにならない可能性もあります。大きく試算値と実測値に剥離があった場合、自動化に伴いテストプロセスの改善の存在を確認し、必要に応じて次のテスト自動化のROIの試算には要素として組み込むことを推奨します。但し、事前にこれらの要素の変化を聖地に見積もることは難しいため、最初はROIの試算に組み込まない方が良いでしょう。

手動テストと自動テストどちらも実施するが変化があるつまりコストが上昇もしくは低下する要素として以下を挙げています。

* テスト環境のメンテナンス (自動化によってトータルコストが上昇する場合もあります)
* テスト実行
* テスト結果の分析
* 障害報告
* テスト結果の報告
* テストデータの生成

テスト自動化で利益つまりコスト削減になるものとしては、下記を挙げています。

* テストの実行
* 業後のテスト実行

第3回以降ではこのCost Benefits Analysis of Test Automationで挙げられている要素を使いながら、ROIを試算していきます。

## 複数の試算式の紹介

ROIの試算式を構成する要素が分かりましたので、次は TABOK と Cost Benefits Analysis of Test Automation で解説している試算式のバリエーションを見ていきます。

### TABOK の3つの試算式

TABOK では Smple ROI Method, Efficiency ROI Method, Risk Reduction ROI Method という3つの試算式を紹介しています。

3つ試算式は Test Automation ROI ( http://www.dijohn-ic.com/test_automation_roi.pdf ) という記事でオープンになっていますので、この記事を参考にしながら解説していきます。

#### Simple ROI Method

Simple ROI Method は以下の式で表されます。分母に自動テストの初期開発コストも含んでいます。

ROI(t) = (手動テストを続けた場合の運用コスト(t) - 自動テストの初期開発コスト - 自動テストの運用コスト(t)) / (自動テストの初期開発コスト + 自動テストの運用コスト(t))

Simple ROI Method はコストの構成要素を金額で積み上げていくもので、以下の特徴を持ったテスト自動化で有効です。

* テスターの単価が明確になっている
* 自動化の投資期間が長い

Simple ROI Method のメリットとデメリットは以下の通りです。

* メリット
 - 金額ベースで積み上げていくためにROIの試算の内訳についてマネジメント層とコミュニケーションが取りやすい
* デメリット
 - テスターの単価が明確ではない場合、適用出来ない
 - 余りに計算を単純化しすぎている
  + 手動テストがそのままテスト設計やカバレッジを変更せずに自動テストに置き換わることは少ない
  + 自動化に伴う欠陥対策コストの減少、手動テストのカバレッジ増加などを無視している

#### Efficiency ROI Method

#### Risk Reduction ROI Method

## ROIとCBA

### Cost Benefits Analysis of Test Automation の2つの試算式
